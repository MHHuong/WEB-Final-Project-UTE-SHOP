<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta content="Codescandy" name="author"/>

    <title th:text="${product.name} + ' - FreshCart'">Shop Single eCommerce HTML Template - FreshCart</title>

    <!-- CSS -->
    <link th:href="@{/assets/libs/dropzone/dist/min/dropzone.min.css}" rel="stylesheet"/>
    <link th:href="@{/assets/libs/tiny-slider/dist/tiny-slider.css}" rel="stylesheet"/>
    <link rel="shortcut icon" type="image/x-icon" th:href="@{/assets/images/favicon/favicon.ico}"/>

    <link th:href="@{/assets/libs/bootstrap-icons/font/bootstrap-icons.min.css}" rel="stylesheet"/>
    <link th:href="@{/assets/libs/feather-webfont/dist/feather-icons.css}" rel="stylesheet"/>
    <link th:href="@{/assets/libs/simplebar/dist/simplebar.min.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/theme.min.css}" rel="stylesheet"/>
</head>

<body>
<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<!-- Optional: client validators -->
<script th:src="@{/assets/js/vendors/validation.js}"></script>

<main>
    <!-- Breadcrumb -->
    <div class="mt-4">
        <div class="container">
            <div class="col-12">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>

                        <li class="breadcrumb-item" th:if="${product.categoryName != null}">
                            <a th:href="@{'/categories/' + ${product.categoryId}}"
                               th:text="${product.categoryName}">
                                Category
                            </a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page" th:text="${product.name}">
                            Product Name
                        </li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <!-- Product -->
    <section class="mt-8">
        <div class="container">
            <div class="row">
                <!-- Gallery -->
                <div class="col-md-5 col-xl-6">
                    <div class="product" id="product">
                        <div th:each="media : ${product.media}" th:if="${media.type == 'IMAGE'}">
                            <div class="zoom" onmousemove="zoom(event)"
                                 th:style="'background-image: url(' + ${media.url} + ')'">
                                <img th:src="${media.url}" alt="Product image"/>
                            </div>
                        </div>
                    </div>
                    <div class="product-tools">
                        <div class="thumbnails row g-3" id="productThumbnails">
                            <div class="col-3" th:each="media : ${product.media}" th:if="${media.type == 'IMAGE'}">
                                <div class="thumbnails-img">
                                    <img th:src="${media.url}" alt="Product thumbnail"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Info -->
                <div class="col-md-7 col-xl-6">
                    <div class="ps-lg-10 mt-6 mt-md-0">
                        <a class="mb-4 d-block"
                           th:href="@{'/categories/' + ${product.categoryId}}"
                           th:text="${product.categoryName}"
                           th:if="${product.categoryName != null}">
                            Bakery Biscuits
                        </a>

                        <h1 class="mb-1" th:text="${product.name}">Product name</h1>

                        <div class="mb-4">
                            <small class="text-warning">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-half"></i>
                            </small>
                            <a href="#reviews-tab-pane" class="ms-2"
                               th:text="'(' + ${product.totalReviews} + ' reviews)'">
                                (0 reviews)
                            </a>
                        </div>

                        <div class="fs-4">
              <span class="fw-bold text-dark"
                    th:text="'$' + ${#numbers.formatDecimal(product.price, 1, 'COMMA', 2, 'POINT')}">
                $0.00
              </span>
                        </div>

                        <hr class="my-6"/>

                        <div>
                            <div class="input-group input-spinner">
                                <input type="button" value="-" class="button-minus btn btn-sm" data-field="quantity"/>
                                <input type="number" step="1" max="10" value="1" name="quantity"
                                       class="quantity-field form-control-sm form-input"/>
                                <input type="button" value="+" class="button-plus btn btn-sm" data-field="quantity"/>
                            </div>
                        </div>

                        <div class="mt-3 row justify-content-start g-2 align-items-center">
                            <div class="col-xxl-4 col-lg-4 col-md-5 col-5 d-grid">
                                <button type="button" class="btn btn-primary">
                                    <i class="feather-icon icon-shopping-bag me-2"></i>
                                    Add to cart
                                </button>
                            </div>
                            <div class="col-md-4 col-4">
                                <a class="btn btn-light" href="#" data-bs-toggle="tooltip" data-bs-html="true" aria-label="Compare">
                                    <i class="bi bi-arrow-left-right"></i></a>
                                <a class="btn btn-light" href="#" data-bs-toggle="tooltip" data-bs-html="true" aria-label="Wishlist">
                                    <i class="feather-icon icon-heart"></i></a>
                            </div>
                        </div>

                        <hr class="my-6"/>

                        <div>
                            <table class="table table-borderless mb-0">
                                <tbody>
                                <tr>
                                    <td>Product Code:</td>
                                    <td th:text="${product.productId}">FBB00255</td>
                                </tr>
                                <tr>
                                    <td>Availability:</td>
                                    <td th:text="${product.stock > 0 ? 'In Stock' : 'Out of Stock'}">In Stock</td>
                                </tr>
                                <tr th:if="${product.categoryName != null}">
                                    <td>Type:</td>
                                    <td th:text="${product.categoryName}">Fruits</td>
                                </tr>
                                <tr>
                                    <td>Shipping:</td>
                                    <td>
                                        <small>
                                            01 day shipping.
                                            <span class="text-muted">( Free pickup today)</span>
                                        </small>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mt-8"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tabs -->
    <section class="mt-lg-14 mt-8">
        <div class="container">
            <div class="row">
                <div class="col-md-12">

                    <ul class="nav nav-pills nav-lb-tab" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="product-tab" data-bs-toggle="tab"
                                    data-bs-target="#product-tab-pane" type="button" role="tab"
                                    aria-controls="product-tab-pane" aria-selected="true">
                                Product Details
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="reviews-tab" data-bs-toggle="tab"
                                    data-bs-target="#reviews-tab-pane" type="button" role="tab"
                                    aria-controls="reviews-tab-pane" aria-selected="false">
                                Reviews
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="sellerInfo-tab" data-bs-toggle="tab"
                                    data-bs-target="#sellerInfo-tab-pane" type="button" role="tab"
                                    aria-controls="sellerInfo-tab-pane" aria-selected="false" disabled>
                                Seller Info
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content" id="myTabContent">
                        <!-- Product details tab -->
                        <div class="tab-pane fade show active" id="product-tab-pane" role="tabpanel"
                             aria-labelledby="product-tab" tabindex="0">
                            <div class="my-8">
                                <div class="mb-5">
                                    <h4 class="mb-1">Product Details</h4>
                                    <!-- FIX: Không dùng T(java.lang.System); dùng pre-line hoặc replace '\n' -->
                                    <p class="mb-0" th:text="${product.description}" style="white-space: pre-line;"></p>
                                    <!-- Hoặc:
                                    <p class="mb-0" th:utext="${#strings.replace(product.description, '\n', '<br/>')}"></p>
                                    -->
                                </div>

                                <div class="mb-5">
                                    <h5 class="mb-1">Seller</h5>
                                    <p class="mb-0" th:text="'Shop ID: ' + ${product.shopId}">[Seller Name]</p>
                                </div>

                                <div>
                                    <h5 class="mb-1">Disclaimer</h5>
                                    <p class="mb-0">
                                        Image shown is a representation and may slightly vary from the actual product.
                                        Every effort is made to maintain accuracy of all information displayed.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Reviews tab -->
                        <div class="tab-pane fade" id="reviews-tab-pane" role="tabpanel" aria-labelledby="reviews-tab" tabindex="0">
                            <div class="my-8">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="me-lg-12 mb-6 mb-md-0">
                                            <div class="mb-5">
                                                <h4 class="mb-3">Customer reviews</h4>
                                                <span>
                          <small class="text-warning">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-half"></i>
                          </small>
                          <span class="ms-3" th:text="${product.avgRating} + ' out of 5'">0.0 out of 5</span>
                          <small class="ms-3" th:text="${product.totalReviews} + ' global ratings'">0 global ratings</small>
                        </span>
                                            </div>

                                            <div class="mb-8"></div>

                                            <div class="d-grid">
                                                <h4>Review this product</h4>
                                                <p class="mb-0">Share your thoughts with other customers.</p>
                                                <a href="#" class="btn btn-outline-gray-400 mt-4 text-muted">Write the Review</a>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-8">
                                        <div class="mb-10">
                                            <div class="d-flex justify-content-between align-items-center mb-8">
                                                <div><h4>Reviews</h4></div>
                                                <div>
                                                    <select class="form-select">
                                                        <option selected>Top Reviews</option>
                                                        <option value="Most Recent">Most Recent</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div th:if="${#lists.isEmpty(reviews)}" class="text-center p-5 border rounded">
                                                <p class="mb-0">This product has no reviews yet. Be the first to write one!</p>
                                            </div>

                                            <div th:each="review : ${reviews}" class="d-flex border-bottom pb-6 mb-6">
                                                <img th:src="@{/assets/images/avatar/avatar-placeholder.jpg}" alt="User avatar" class="rounded-circle avatar-lg"/>
                                                <div class="ms-5">
                                                    <h6 class="mb-1" th:text="${review.userName}">[Reviewer Name]</h6>
                                                    <p class="small">
                            <span class="text-muted" th:text="${#temporals.format(review.createdAt, 'dd MMMM yyyy')}">
                              01 January 2025
                            </span>
                                                    </p>
                                                    <div class="mb-2">
                            <span th:each="star : ${#numbers.sequence(1, 5)}">
                              <i class="bi" th:classappend="${star <= review.rating} ? 'bi-star-fill text-warning' : 'bi-star text-warning'"></i>
                            </span>
                                                    </div>
                                                    <p th:text="${review.comment}">[Review comment content]</p>

                                                    <div class="d-flex">
                                                        <div th:each="media : ${review.media}" class="border icon-shape icon-lg border-2 ms-1">
                                                            <img th:src="${media.url}" alt="Review media" class="img-fluid" th:if="${media.type == 'IMAGE'}"/>
                                                        </div>
                                                    </div>

                                                    <div class="d-flex justify-content-end mt-4">
                                                        <a href="#" class="text-muted"><i class="feather-icon icon-thumbs-up me-1"></i> Helpful</a>
                                                        <a href="#" class="text-muted ms-4"><i class="feather-icon icon-flag me-2"></i> Report abuse</a>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div> <!-- row -->
                            </div>
                        </div>

                        <div class="tab-pane fade" id="sellerInfo-tab-pane" role="tabpanel" aria-labelledby="sellerInfo-tab" tabindex="0">
                            <!-- Seller Info content ... -->
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <section class="my-lg-14 my-14"></section>
</main>

<footer class="footer">
    <!-- footer content -->
</footer>

<!-- (Optional) Quick View Modal: bỏ qua nếu chưa dùng
<div class="modal fade" id="quickViewModal" tabindex="-1" aria-hidden="true"></div>
-->

<!-- JS -->
<script th:src="@{/assets/libs/rater-js/index.js}"></script>
<script th:src="@{/assets/libs/dropzone/dist/min/dropzone.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/assets/libs/simplebar/dist/simplebar.min.js}"></script>
<script th:src="@{/assets/js/theme.min.js}"></script>
<script th:src="@{/assets/js/vendors/jquery.min.js}"></script>
<script th:src="@{/assets/libs/tiny-slider/dist/min/tiny-slider.js}"></script>
<script th:src="@{/assets/js/vendors/tns-slider.js}"></script>
<script th:src="@{/assets/js/vendors/zoom.js}"></script>
<script th:src="@{/assets/js/vendors/dropzone.js}"></script>
</body>
</html>