<div th:fragment = "success" id="success-state" style="display: none;">
    <div class="mb-4">
        <div class="success-checkmark">
            <div class="check-icon">
                <span class="icon-line line-tip"></span>
                <span class="icon-line line-long"></span>
                <div class="icon-circle"></div>
                <div class="icon-fix"></div>
            </div>
        </div>
    </div>
    <h2 class="fw-bold text-success mb-3">
        Place Order Successfully!!
    </h2>
    <p class="text-muted mb-4">
        Thank you for your purchase! Your order has been placed successfully and is being processed.
    </p>
</div>

<div th:fragment = "pending" id="pending-state" style="display: none;">
    <div class="mb-4">
        <div class="pending-icon">
            <i class="bi bi-hourglass-split text-secondary"></i>
        </div>
    </div>
    <h2 class="fw-bold text-secondary mb-3">
        Pending Payment
    </h2>
    <p class="text-muted mb-3">
        Please complete your payment within the allotted time to confirm your order.
    </p>

    <!-- Timer -->
    <div class="countdown-timer mb-4">
        <div class="timer-box">
            <span id="timer-display" class="timer-text">15:00</span>
            <small class="text-muted d-block mt-2">
                Time remaining to complete payment
            </small>
        </div>
    </div>

    <!-- Payment Button -->
    <div class="mb-3">
        <button class="btn btn-success btn-lg px-5" id="pay-now-btn">
            <i class="bi bi-credit-card me-2"></i>
            Pay Now
        </button>
    </div>
    <small class="text-muted">
        Note: If the payment is not completed within the time limit, the order will be automatically cancelled.
    </small>
</div>

<div th:fragment = "failed" id="failed-state" style="display: none;">
    <div class="mb-4">
        <div class="failed-icon">
            <i class="bi bi-x-circle-fill text-danger"></i>
        </div>
    </div>
    <h2 class="fw-bold text-danger mb-3">
        Payment Failed
    </h2>
    <p class="text-muted mb-4" id="failed-message">
        Unfortunately, your payment could not be processed. Please try again.
    </p>

    <!-- Retry Button -->
    <div class="mb-3">
        <button class="btn btn-success btn-lg px-5" id="retry-payment-btn">
            <i class="bi bi-arrow-clockwise me-2"></i>
            Retry Payment
        </button>
    </div>
</div>

<!-- Order Status Timeline Fragment -->
<div th:fragment="order-timeline" id="order-timeline-container">
    <div class="order-status-timeline">
        <div class="timeline-header mb-4">
            <h4 class="mb-2">
                Order Status
            </h4>
            <p class="text-muted mb-0" id="current-status-text">Loading...</p>
        </div>
        <div class="timeline-wrapper-horizontal">
            <!-- Timeline items will be rendered dynamically -->
            <div class="timeline-item-horizontal" data-status="NEW">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-file-earmark-text"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">New Order</h6>
                    <p class="timeline-desc-horizontal">
                        Waiting for confirmation
                    </p>
                </div>
            </div>

            <div class="timeline-line-horizontal"></div>

            <div class="timeline-item-horizontal" data-status="CONFIRMED">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-check-circle"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">
                        Confirmed
                    </h6>
                    <p class="timeline-desc-horizontal">
                        Processing order
                    </p>
                </div>
            </div>

            <div class="timeline-line-horizontal"></div>

            <div class="timeline-item-horizontal" data-status="SHIPPING">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-truck"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">
                        Shipping
                    </h6>
                    <p class="timeline-desc-horizontal">
                        On the way
                    </p>
                </div>
            </div>

            <div class="timeline-line-horizontal"></div>

            <div class="timeline-item-horizontal" data-status="DELIVERED">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-box-seam"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">
                        Delivered
                    </h6>
                    <p class="timeline-desc-horizontal">
                        Order received
                    </p>
                </div>
            </div>

            <!-- Cancelled Status (shown if order is cancelled) -->
            <div class="timeline-item-horizontal timeline-item-cancelled" data-status="CANCELLED" style="display: none;">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-x-circle"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">
                        Cancelled
                    </h6>
                    <p class="timeline-desc-horizontal">
                        Order cancelled
                    </p>
                </div>
            </div>

            <div class="timeline-item-horizontal timeline-item-returned" data-status="RETURNED" style="display: none;">
                <div class="timeline-dot-horizontal"></div>
                <div class="timeline-content-horizontal">
                    <div class="timeline-icon-horizontal">
                        <i class="bi bi-arrow-return-left"></i>
                    </div>
                    <h6 class="timeline-title-horizontal">
                        Returned
                    </h6>
                    <p class="timeline-desc-horizontal">
                        Order returned
                    </p>
                </div>
            </div>
        </div>
    </div>
    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <style>
        /* Horizontal Timeline Styles */
        .order-status-timeline {
            padding: 20px 0;
        }

        .timeline-header {
            text-align: center;
        }

        .timeline-wrapper-horizontal {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            flex-wrap: nowrap;
            overflow-x: auto;
            gap: 0;
        }

        .timeline-item-horizontal {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-width: 120px;
            opacity: 0.4;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .timeline-item-horizontal.active,
        .timeline-item-horizontal.completed {
            opacity: 1;
        }

        .timeline-line-horizontal {
            flex: 1;
            height: 4px;
            background-color: #e0e0e0;
            margin: 30px 0 0 0;
            min-width: 60px;
            transition: all 0.3s ease;
            z-index: 1;
        }

        .timeline-line-horizontal.completed {
            background: linear-gradient(to right, #0aad0a, #0aad0a);
        }

        .timeline-dot-horizontal {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #e0e0e0;
            border: 4px solid #fff;
            box-shadow: 0 0 0 3px #e0e0e0;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .timeline-item-horizontal.active .timeline-dot-horizontal {
            background-color: #0aad0a;
            box-shadow: 0 0 0 3px rgba(10, 173, 10, 0.3);
            animation: pulse-dot-horizontal 2s infinite;
        }

        .timeline-item-horizontal.completed .timeline-dot-horizontal {
            background-color: #0aad0a;
            box-shadow: 0 0 0 3px rgba(10, 173, 10, 0.2);
        }

        .timeline-item-cancelled .timeline-dot-horizontal,
        .timeline-item-cancelled.active .timeline-dot-horizontal {
            background-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.3);
        }

        .timeline-item-returned .timeline-dot-horizontal,
        .timeline-item-returned.active .timeline-dot-horizontal {
            background-color: #fd7e14;
            box-shadow: 0 0 0 3px rgba(253, 126, 20, 0.3);
        }

        @keyframes pulse-dot-horizontal {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        .timeline-content-horizontal {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .timeline-icon-horizontal {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: #6c757d;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .timeline-item-horizontal.active .timeline-icon-horizontal,
        .timeline-item-horizontal.completed .timeline-icon-horizontal {
            background-color: rgba(10, 173, 10, 0.1);
            color: #0aad0a;
        }

        .timeline-item-cancelled .timeline-icon-horizontal,
        .timeline-item-cancelled.active .timeline-icon-horizontal {
            background-color: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .timeline-item-returned .timeline-icon-horizontal,
        .timeline-item-returned.active .timeline-icon-horizontal {
            background-color: rgba(253, 126, 20, 0.1);
            color: #fd7e14;
        }

        .timeline-title-horizontal {
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 14px;
            color: #6c757d;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .timeline-item-horizontal.active .timeline-title-horizontal,
        .timeline-item-horizontal.completed .timeline-title-horizontal {
            color: #212529;
        }

        .timeline-desc-horizontal {
            margin-bottom: 0;
            font-size: 12px;
            color: #999;
            white-space: nowrap;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .timeline-wrapper-horizontal {
                padding: 30px 10px;
                gap: 0;
            }

            .timeline-item-horizontal {
                min-width: 80px;
            }

            .timeline-line-horizontal {
                min-width: 30px;
            }

            .timeline-icon-horizontal {
                width: 45px;
                height: 45px;
                font-size: 22px;
            }

            .timeline-title-horizontal {
                font-size: 12px;
            }

            .timeline-desc-horizontal {
                font-size: 10px;
            }

            .timeline-dot-horizontal {
                width: 18px;
                height: 18px;
            }
        }

        @media (max-width: 576px) {
            .timeline-wrapper-horizontal {
                justify-content: flex-start;
                padding: 20px 5px;
            }

            .timeline-item-horizontal {
                min-width: 70px;
            }

            .timeline-line-horizontal {
                min-width: 20px;
            }
        }
    </style>
</div>
